# alphacar-integrated-ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: alphacar-integrated-ingress
  namespace: apc-fe-ns # 프론트엔드 네임스페이스 기준
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    # ✅ 이 그룹명이 같아야 프론트와 백엔드가 하나의 주소를 공유합니다.
    alb.ingress.kubernetes.io/group.name: alphacar-web-group
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}]'
spec:
  rules:
  - http:
      paths:
      # [1] API 요청 (백엔드로 전달)
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: main-backend # 실제 백엔드 서비스 명칭 확인 필요
            port:
              number: 3002
      # [2] 기본 요청 (프론트엔드로 전달)
      - path: /
        pathType: Prefix
        backend:
          service:
            name: frontend
            port:
              number: 8000
