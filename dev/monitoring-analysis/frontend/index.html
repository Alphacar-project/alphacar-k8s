<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kubernetes GenAI ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background: #1f1f23;
            min-height: 100vh;
            color: #d8d9da;
        }
        
        /* ì‘ì€ í”Œë¡œíŒ… ë„¤ë¹„ê²Œì´ì…˜ */
        .sidebar-nav {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            background: #2b2b2f;
            border: 1px solid #3d3d42;
            border-radius: 8px;
            z-index: 90;
            padding: 8px 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .nav-item {
            padding: 10px;
            color: #9e9e9e;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.2s;
            border-radius: 4px;
            text-align: center;
            margin-bottom: 4px;
            position: relative;
        }
        .nav-item:hover {
            background: #3d3d42;
            color: #d8d9da;
        }
        .nav-item:hover::after {
            content: attr(data-label);
            position: absolute;
            left: 60px;
            top: 50%;
            transform: translateY(-50%);
            background: #2b2b2f;
            color: #d8d9da;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            border: 1px solid #3d3d42;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }
        .nav-item.active {
            background: #3274d9;
            color: #fff;
        }
        
        /* í—¤ë” */
        .header {
            background: #2b2b2f;
            border-bottom: 1px solid #3d3d42;
            padding: 20px 24px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #d8d9da;
        }
        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .node-selector select {
            padding: 6px 12px;
            background: #1f1f23;
            border: 1px solid #3d3d42;
            border-radius: 2px;
            color: #d8d9da;
            font-size: 13px;
        }
        
        /* ë©”ì¸ ì»¨í…ì¸  */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }
        
        /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section {
            margin-bottom: 48px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }
        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .section-title {
            font-size: 28px;
            font-weight: 600;
            color: #d8d9da;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #3274d9;
        }
        
        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: #2b2b2f;
            border-radius: 4px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            border: 1px solid #3d3d42;
            margin-bottom: 24px;
        }
        .card h3 {
            font-size: 18px;
            font-weight: 500;
            color: #d8d9da;
            margin-bottom: 16px;
            border-bottom: 1px solid #3d3d42;
            padding-bottom: 8px;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (min-width: 1400px) {
            .grid {
                grid-template-columns: repeat(4, 1fr);
            }
            .main-content {
                max-width: 1600px;
            }
        }
        @media (min-width: 1024px) and (max-width: 1399px) {
            .grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        @media (min-width: 768px) and (max-width: 1023px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .main-content {
                padding: 16px;
            }
        }
        @media (max-width: 767px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .main-content {
                padding: 12px;
            }
            .section-title {
                font-size: 22px;
            }
            .sidebar-nav {
                left: 10px;
                width: 40px;
            }
            .header {
                padding: 16px;
                flex-direction: column;
                gap: 12px;
            }
            .header h1 {
                font-size: 20px;
            }
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
        }
        
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn {
            background: #3274d9;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn:hover {
            background: #4080e8;
        }
        .btn-secondary {
            background: #464650;
        }
        .btn-secondary:hover {
            background: #52525c;
        }
        
        /* ì…ë ¥ í•„ë“œ */
        input, select {
            width: 100%;
            padding: 10px 12px;
            margin: 8px 0;
            border: 1px solid #3d3d42;
            border-radius: 4px;
            font-size: 14px;
            background: #1f1f23;
            color: #d8d9da;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3274d9;
            box-shadow: 0 0 0 2px rgba(50, 116, 217, 0.2);
        }
        
        /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ */
        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 16px;
            background: #1f1f23;
            border-radius: 4px;
            padding: 16px;
        }
        
        /* ìƒíƒœ í‘œì‹œ */
        .status {
            padding: 12px 16px;
            border-radius: 4px;
            font-size: 14px;
            border-left: 4px solid;
            margin-top: 16px;
        }
        .status.success {
            background: rgba(46, 160, 67, 0.15);
            color: #73bf69;
            border-left-color: #73bf69;
        }
        .status.error {
            background: rgba(211, 47, 47, 0.15);
            color: #e57373;
            border-left-color: #e57373;
        }
        .status.warning {
            background: rgba(237, 212, 0, 0.15);
            color: #fdd835;
            border-left-color: #fdd835;
        }
        
        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .table-container {
            overflow-x: auto;
            margin-top: 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        th {
            background: #1f1f23;
            color: #9e9e9e;
            padding: 12px;
            text-align: left;
            font-weight: 500;
            border-bottom: 1px solid #3d3d42;
        }
        td {
            padding: 12px;
            border-bottom: 1px solid #3d3d42;
            color: #d8d9da;
        }
        tr:hover {
            background: #3d3d42;
        }
        
        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(50, 116, 217, 0.2);
            border-top: 2px solid #3274d9;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .hidden { display: none; }
        
        /* ë©”íŠ¸ë¦­ ì¹´ë“œ */
        .metric-card {
            background: #2b2b2f;
            border: 1px solid #3d3d42;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
            min-height: 160px;
            display: flex;
            flex-direction: column;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            border-color: #3274d9;
        }
        .metric-value {
            font-size: 28px;
            font-weight: 600;
            color: #3274d9;
            margin: 8px 0;
            line-height: 1.2;
        }
        .metric-label {
            font-size: 14px;
            color: #9e9e9e;
            text-transform: uppercase;
        }
        
        /* ë¶„ì„ ê²°ê³¼ */
        .analysis-result {
            background: #2b2b2f;
            border: 1px solid #3d3d42;
            border-radius: 4px;
            padding: 20px;
            margin-top: 16px;
        }
        .analysis-text {
            background: #1f1f23;
            padding: 16px;
            border-radius: 4px;
            line-height: 1.8;
            white-space: pre-line;
            font-size: 14px;
            color: #d8d9da;
            border-left: 3px solid #3274d9;
        }
        
        /* ë¦¬ì†ŒìŠ¤ ê·¸ë¦¬ë“œ */
        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 24px;
        }
        
        /* ê²€ìƒ‰ ê°€ëŠ¥í•œ ì…€ë ‰íŠ¸ ë°•ìŠ¤ */
        .searchable-select {
            position: relative;
            margin-bottom: 16px;
        }
        .searchable-select input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #3d3d42;
            border-radius: 4px;
            background: #1f1f23;
            color: #d8d9da;
            font-size: 14px;
        }
        .searchable-select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #2b2b2f;
            border: 1px solid #3d3d42;
            border-radius: 4px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-top: 4px;
        }
        .searchable-select-dropdown.show {
            display: block;
        }
        .searchable-select-option {
            padding: 10px 12px;
            cursor: pointer;
            color: #d8d9da;
            border-bottom: 1px solid #3d3d42;
        }
        .searchable-select-option:hover {
            background: #3d3d42;
        }
        .searchable-select-option.selected {
            background: #3274d9;
            color: white;
        }
        .selected-pod-badge {
            display: inline-block;
            background: #3274d9;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 8px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- ì‘ì€ í”Œë¡œíŒ… ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="sidebar-nav">
        <div class="nav-item active" data-label="í´ëŸ¬ìŠ¤í„° ê°œìš”" onclick="scrollToSection('section-cluster-overview')">ğŸ“Š</div>
        <div class="nav-item" data-label="ì¡°ê¸° ê²½ê³ " onclick="scrollToSection('section-early-warning')">ğŸš¨</div>
        <div class="nav-item" data-label="ì„±ëŠ¥ ë©”íŠ¸ë¦­" onclick="scrollToSection('section-performance-metrics')">âš¡</div>
        <div class="nav-item" data-label="ì‹œìŠ¤í…œ ë¶€í•˜" onclick="scrollToSection('section-system-load')">ğŸ¯</div>
        <div class="nav-item" data-label="ê°€ìš©ì„± ë° ì˜ˆì‚°" onclick="scrollToSection('section-availability-budget')">â¤ï¸</div>
        <div class="nav-item" data-label="ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥ " onclick="scrollToSection('section-resources')">ğŸ’»</div>
        <div class="nav-item" data-label="íŒŒë“œ ë¶„ì„" onclick="scrollToSection('section-pod-analysis')">ğŸ”</div>
        <div class="nav-item" data-label="Pod ìƒíƒœ ëª¨ë‹ˆí„°ë§" onclick="scrollToSection('section-pod-status')">ğŸ“ˆ</div>
        <div class="nav-item" data-label="ë…¸ë“œ ìƒíƒœ ëª¨ë‹ˆí„°ë§" onclick="scrollToSection('section-node-status')">ğŸ–¥ï¸</div>
        <div class="nav-item" data-label="AI ë¶„ì„" onclick="scrollToSection('section-ai-analysis')">ğŸ¤–</div>
    </div>
    
    <!-- í—¤ë” -->
    <div class="header">
        <h1>â˜¸ï¸ Kubernetes GenAI ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</h1>
        <div class="header-actions">
            <select id="nodeSelector">
                <option value="all">ëª¨ë“  ë…¸ë“œ</option>
            </select>
            <span style="font-size: 12px; color: #9e9e9e; margin-right: 8px;">30ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨</span>
            <button class="btn btn-secondary" onclick="refreshAll()">ğŸ”„ ì „ì²´ ìƒˆë¡œê³ ì¹¨</button>
        </div>
    </div>
    
    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="main-content">
        <!-- í´ëŸ¬ìŠ¤í„° ê°œìš” ì„¹ì…˜ -->
        <section id="section-cluster-overview" class="section">
            <h2 class="section-title">í´ëŸ¬ìŠ¤í„° ê°œìš”</h2>
            <div class="card">
                <h3>í´ëŸ¬ìŠ¤í„° ìƒíƒœ</h3>
                <button class="btn" onclick="checkK8sStatus()">ìƒíƒœ ë¶„ì„</button>
                <div id="clusterStatus"></div>
            </div>
            <div class="grid">
                <div class="metric-card">
                    <div class="metric-label">ì „ì²´ ë…¸ë“œ</div>
                    <div class="metric-value" id="totalNodes">-</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">ì „ì²´ Pod</div>
                    <div class="metric-value" id="totalPods">-</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Running Pod</div>
                    <div class="metric-value" id="runningPods">-</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">ê±´ê°• ì ìˆ˜</div>
                    <div class="metric-value" id="healthScore">-</div>
                </div>
            </div>
        </section>
        
        <!-- ì¡°ê¸° ê²½ê³  ì„¹ì…˜ -->
        <section id="section-early-warning" class="section">
            <h2 class="section-title">ì¡°ê¸° ê²½ê³  (Catch It Early)</h2>
            <div id="earlyWarningSummary" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                <!-- ìš”ì•½ ì¹´ë“œëŠ” ë™ì ìœ¼ë¡œ ìƒì„± -->
            </div>
            <div id="earlyWarningAlerts" class="card">
                <h3 style="margin-bottom: 16px;">ì‹¤ì‹œê°„ ì•Œë¦¼</h3>
                <div id="earlyWarningList" style="display: flex; flex-direction: column; gap: 12px;">
                    <div style="text-align: center; padding: 40px; color: #9e9e9e;">
                        <div class="loading"></div> ë¡œë”© ì¤‘...
                    </div>
                </div>
            </div>
        </section>
        
        <!-- ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì„¹ì…˜ -->
        <section id="section-performance-metrics" class="section">
            <h2 class="section-title">ì„±ëŠ¥ ë©”íŠ¸ë¦­</h2>
            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
                <!-- Latency -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">â±ï¸</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Latency</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">ìš”ì²­ ì²˜ë¦¬ ì§€ì—° ì‹œê°„</div>
                    <div class="metric-value" id="latencyValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="latencyTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
                
                <!-- Error rate -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">ğŸ©¸</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Error rate</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">ì—ëŸ¬ ë°œìƒ ë¹„ìœ¨</div>
                    <div class="metric-value" id="errorRateValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="errorRateTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
                
                <!-- Throughput -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">ğŸ“Š</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Throughput</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">ì´ˆë‹¹ ì²˜ë¦¬ ìš”ì²­ ìˆ˜</div>
                    <div class="metric-value" id="throughputValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="throughputTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
                
                <!-- Reqs/sec -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">âš¡</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Reqs/sec</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">ì´ˆë‹¹ ìš”ì²­ ìˆ˜</div>
                    <div class="metric-value" id="rpsValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="rpsTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
            </div>
        </section>
        
        <!-- ì‹œìŠ¤í…œ ë¶€í•˜ ë©”íŠ¸ë¦­ ì„¹ì…˜ -->
        <section id="section-system-load" class="section">
            <h2 class="section-title">ì‹œìŠ¤í…œ ë¶€í•˜</h2>
            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
                <!-- Saturation -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">ğŸ¯</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Saturation</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">CPU/Memory í¬í™”ë„</div>
                    <div class="metric-value" id="saturationValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="saturationTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
                
                <!-- Queue depth -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">ğŸ“‹</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Queue depth</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">Pod ìŠ¤ì¼€ì¤„ë§ ëŒ€ê¸° í</div>
                    <div class="metric-value" id="queueDepthValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="queueDepthTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
                
                <!-- Load -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">âš–ï¸</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Load</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">ë…¸ë“œë³„ ë¡œë“œ í‰ê· </div>
                    <div class="metric-value" id="loadValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="loadTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
            </div>
        </section>
        
        <!-- ê°€ìš©ì„± ë° ì˜ˆì‚° ë©”íŠ¸ë¦­ ì„¹ì…˜ -->
        <section id="section-availability-budget" class="section">
            <h2 class="section-title">ê°€ìš©ì„± ë° ì˜ˆì‚°</h2>
            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
                <!-- Availability -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">â¤ï¸</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Availability</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">ì„œë¹„ìŠ¤ ê°€ìš©ì„±</div>
                    <div class="metric-value" id="availabilityValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="availabilityTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
                
                <!-- Error budget -->
                <div class="metric-card" style="padding: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">ğŸ’°</span>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Error budget</h3>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #9e9e9e; margin-bottom: 8px;">SLO ê¸°ë°˜ ì—ëŸ¬ ì˜ˆì‚°</div>
                    <div class="metric-value" id="errorBudgetValue" style="font-size: 28px; margin-bottom: 8px; color: #3274d9;">-</div>
                    <div id="errorBudgetMinutes" style="font-size: 12px; color: #9e9e9e; margin-bottom: 4px;">-</div>
                    <div style="font-size: 11px; color: #9e9e9e; margin-bottom: 4px;">ë³€í™” ì¶”ì„¸</div>
                    <div id="errorBudgetTrend" style="font-size: 12px; color: #9e9e9e;">-</div>
                </div>
            </div>
        </section>
        
        <!-- ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥  ì„¹ì…˜ -->
        <section id="section-resources" class="section">
            <h2 class="section-title">ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥ </h2>
            <div class="card" style="margin-bottom: 24px;">
                <h3>Pod ì„ íƒ</h3>
                <div class="searchable-select">
                    <input type="text" id="podSearchInput" placeholder="Pod ê²€ìƒ‰ (ì „ì²´ ë³´ë ¤ë©´ ë¹„ì›Œë‘ì„¸ìš”)" oninput="filterPods(this.value)" onfocus="showPodDropdown()">
                    <div id="podDropdown" class="searchable-select-dropdown"></div>
                </div>
                <div id="selectedPodInfo"></div>
            </div>
            <div class="resource-grid">
                <!-- Container CPU -->
                <div class="card">
                    <h3>Container CPU ì‚¬ìš©ë¥ </h3>
                    <div class="chart-container">
                        <canvas id="containerCpuChart"></canvas>
                    </div>
                    <div class="table-container">
                        <table id="containerCpuTable">
                            <thead>
                                <tr>
                                    <th>ë„¤ì„ìŠ¤í˜ì´ìŠ¤</th>
                                    <th>Pod</th>
                                    <th>Container</th>
                                    <th>CPU ì‚¬ìš©ë¥ </th>
                                    <th>CPU Limit</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Container Memory -->
                <div class="card">
                    <h3>Container Memory ì‚¬ìš©ë¥ </h3>
                    <div class="chart-container">
                        <canvas id="containerMemoryChart"></canvas>
                    </div>
                    <div class="table-container">
                        <table id="containerMemoryTable">
                            <thead>
                                <tr>
                                    <th>ë„¤ì„ìŠ¤í˜ì´ìŠ¤</th>
                                    <th>Pod</th>
                                    <th>Container</th>
                                    <th>Memory ì‚¬ìš©ëŸ‰</th>
                                    <th>Memory Limit</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Pod CPU -->
                <div class="card">
                    <h3>Pod CPU ì‚¬ìš©ë¥ </h3>
                    <div class="chart-container">
                        <canvas id="podCpuChart"></canvas>
                    </div>
                    <div class="table-container">
                        <table id="podCpuTable">
                            <thead>
                                <tr>
                                    <th>ë„¤ì„ìŠ¤í˜ì´ìŠ¤</th>
                                    <th>Pod</th>
                                    <th>CPU ì‚¬ìš©ë¥ </th>
                                    <th>CPU Request</th>
                                    <th>CPU Limit</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Pod Memory -->
                <div class="card">
                    <h3>Pod Memory ì‚¬ìš©ë¥ </h3>
                    <div class="chart-container">
                        <canvas id="podMemoryChart"></canvas>
                    </div>
                    <div class="table-container">
                        <table id="podMemoryTable">
                            <thead>
                                <tr>
                                    <th>ë„¤ì„ìŠ¤í˜ì´ìŠ¤</th>
                                    <th>Pod</th>
                                    <th>Memory ì‚¬ìš©ëŸ‰</th>
                                    <th>Memory Request</th>
                                    <th>Memory Limit</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- íŒŒë“œ ë¶„ì„ ì„¹ì…˜ -->
        <section id="section-pod-analysis" class="section">
            <h2 class="section-title">íŒŒë“œ ë¶„ì„</h2>
            <div class="card">
                <h3>Pod ìƒì„¸ ë¶„ì„</h3>
                <p style="margin-bottom: 16px; color: #9e9e9e;">Pod ì´ë¦„ê³¼ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì…ë ¥í•˜ë©´ AIê°€ kubectl describeì™€ logsë¥¼ ë¶„ì„í•˜ì—¬ ë¬¸ì œì ê³¼ í•´ê²°ì±…ì„ ì œì‹œí•©ë‹ˆë‹¤.</p>
                <input type="text" id="podAnalysisName" placeholder="Pod ì´ë¦„ (í•„ìˆ˜)" required>
                <input type="text" id="podAnalysisNamespace" placeholder="ë„¤ì„ìŠ¤í˜ì´ìŠ¤ (ê¸°ë³¸ê°’: default)" value="default">
                <button class="btn" onclick="analyzePod()">ğŸ” Pod ë¶„ì„ ì‹œì‘</button>
                <div id="podAnalysisStatus"></div>
                <div id="podAnalysisResult" class="hidden"></div>
            </div>
        </section>
        
        <!-- Pod ìƒíƒœ ëª¨ë‹ˆí„°ë§ ì„¹ì…˜ -->
        <section id="section-pod-status" class="section">
            <h2 class="section-title">Pod ìƒíƒœ ëª¨ë‹ˆí„°ë§</h2>
            <div class="card">
                <h3>Pod ìƒíƒœ ìš”ì•½</h3>
                <div id="podStatusSummary" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px;"></div>
                <button class="btn" onclick="loadPodStatus()">ìƒíƒœ ìƒˆë¡œê³ ì¹¨</button>
                <div id="podStatusDetails" style="margin-top: 16px;"></div>
            </div>
        </section>
        
        <!-- ë…¸ë“œ ìƒíƒœ ëª¨ë‹ˆí„°ë§ ì„¹ì…˜ -->
        <section id="section-node-status" class="section">
            <h2 class="section-title">ë…¸ë“œ ìƒíƒœ ëª¨ë‹ˆí„°ë§</h2>
            <div class="card">
                <h3>ë…¸ë“œ ìƒíƒœ ìš”ì•½</h3>
                <div id="nodeStatusSummary" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px;"></div>
                <button class="btn" onclick="loadNodeStatus()">ìƒíƒœ ìƒˆë¡œê³ ì¹¨</button>
                <div id="nodeStatusDetails" style="margin-top: 16px;"></div>
            </div>
        </section>
        
        <!-- AI ë¶„ì„ ì„¹ì…˜ -->
        <section id="section-ai-analysis" class="section">
            <h2 class="section-title">AI ë¶„ì„</h2>
            <div class="grid">
                <div class="card">
                    <h3>ğŸ“ˆ K8s ë©”íŠ¸ë¦­ ë¶„ì„</h3>
                    <select id="k8sMetricsQuery">
                        <option value="up">í´ëŸ¬ìŠ¤í„° ê°€ìš©ì„± (up)</option>
                        <option value="kube_pod_status_phase">Pod ìƒíƒœ ë¶„í¬</option>
                        <option value="kube_node_status_condition">ë…¸ë“œ ìƒíƒœ</option>
                        <option value="container_cpu_usage_seconds_total">CPU ì‚¬ìš©ë¥ </option>
                        <option value="container_memory_working_set_bytes">ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</option>
                    </select>
                    <input type="text" id="metricsQuery" placeholder="ë˜ëŠ” ì§ì ‘ PromQL ì…ë ¥">
                    <button class="btn" onclick="analyzeMetrics()">ë¶„ì„ ì‹œì‘</button>
                    <div id="metricsStatus"></div>
                    <div id="metricsAnalysis" class="hidden"></div>
                    <div id="metricsChart" class="chart-container hidden"></div>
                </div>
                <div class="card">
                    <h3>ğŸ“ K8s Pod ë¡œê·¸ ë¶„ì„</h3>
                    <input type="text" id="podName" placeholder="Pod ì´ë¦„ (ì„ íƒì‚¬í•­)">
                    <input type="text" id="namespace" placeholder="ë„¤ì„ìŠ¤í˜ì´ìŠ¤ (ì„ íƒì‚¬í•­)">
                    <select id="logLevel">
                        <option value="error">Error</option>
                        <option value="warning">Warning</option>
                        <option value="info">Info</option>
                    </select>
                    <input type="number" id="logHours" placeholder="ì‹œê°„ ë²”ìœ„ (ì‹œê°„)" value="1" min="1" max="24">
                    <button class="btn" onclick="analyzeLogs()">ë¶„ì„ ì‹œì‘</button>
                    <div id="logsStatus"></div>
                    <div id="logsAnalysis" class="hidden"></div>
                </div>
                <div class="card">
                    <h3>ğŸ” íŠ¸ë ˆì´ìŠ¤ ë¶„ì„</h3>
                    <input type="text" id="traceService" placeholder="ì„œë¹„ìŠ¤ ì´ë¦„ (ì„ íƒì‚¬í•­)">
                    <button class="btn" onclick="analyzeTraces()">ë¶„ì„ ì‹œì‘</button>
                    <div id="tracesStatus"></div>
                    <div id="tracesAnalysis" class="hidden"></div>
                    <div id="tracesChart" class="chart-container hidden"></div>
                </div>
            </div>
        </section>
        
    </div>
    
    <script>
        const API_BASE = '/api';
        let charts = {};
        let loadedSections = new Set();
        let allPods = [];
        let selectedPod = null;
        let selectedNamespace = null;
        let podListCache = null;
        
        // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function safeHtml(text) {
            if (!text) return '';
            return escapeHtml(text).replace(/\n/g, '<br>');
        }
        
        // ìŠ¤í¬ë¡¤ ê°ì§€ ë° ì„¹ì…˜ í‘œì‹œ
        function handleScroll() {
            const sections = document.querySelectorAll('.section');
            const windowHeight = window.innerHeight;
            const headerHeight = 80;
            
            let activeSection = null;
            
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                const isVisible = rect.top < windowHeight * 0.8 && rect.bottom > 0;
                
                if (isVisible && !section.classList.contains('visible')) {
                    section.classList.add('visible');
                    const sectionId = section.id;
                    
                    // ì„¹ì…˜ë³„ ë°ì´í„° ë¡œë“œ
                    if (!loadedSections.has(sectionId)) {
                        loadSectionData(sectionId);
                        loadedSections.add(sectionId);
                    }
                }
                
                // í˜„ì¬ ë³´ì´ëŠ” ì„¹ì…˜ ì°¾ê¸°
                if (rect.top <= headerHeight + 100 && rect.bottom > headerHeight + 100) {
                    activeSection = section.id;
                }
            });
            
            // ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™” ì—…ë°ì´íŠ¸
            if (activeSection) {
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('onclick')?.includes(activeSection)) {
                        item.classList.add('active');
                    }
                });
            }
        }
        
        // ì„¹ì…˜ë³„ ë°ì´í„° ë¡œë“œ
        function loadSectionData(sectionId) {
            switch(sectionId) {
                case 'section-cluster-overview':
                    loadClusterOverview();
                    loadClusterStats();
                    break;
                case 'section-performance-metrics':
                    loadPerformanceMetrics();
                    break;
                case 'section-system-load':
                    loadSystemLoadMetrics();
                    break;
                case 'section-availability-budget':
                    loadAvailabilityBudgetMetrics();
                    break;
                case 'section-early-warning':
                    loadEarlyWarning();
                    break;
                case 'section-resources':
                    loadPodList();
                    // ì²˜ìŒì—ëŠ” Pod ì„ íƒ ì—†ì´ ë¹ˆ ìƒíƒœë¡œ ì‹œì‘
                    // Pod ì„ íƒ ì‹œì—ë§Œ ë°ì´í„° ë¡œë“œ
                    break;
                case 'section-pod-analysis':
                    // ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ ë¶„ì„ ì‹œì‘
                    break;
                case 'section-pod-status':
                    loadPodStatus();
                    break;
                case 'section-node-status':
                    loadNodeStatus();
                    break;
                case 'section-ai-analysis':
                    // ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ ë¶„ì„ ì‹œì‘
                    break;
            }
        }
        
        // ì „ì²´ ìƒˆë¡œê³ ì¹¨
        function refreshAll() {
            loadedSections.clear();
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('visible');
            });
            handleScroll();
        }
        
        // í´ëŸ¬ìŠ¤í„° ê°œìš” ë¡œë“œ
        async function loadClusterOverview() {
            try {
                // ê±´ê°• ì ìˆ˜ë§Œ ë¡œë“œ (ìƒíƒœ ë¶„ì„ì€ ë²„íŠ¼ í´ë¦­ ì‹œì—ë§Œ ì‹¤í–‰)
                const res = await fetch(`${API_BASE}/k8s/status`);
                const data = await res.json();
                
                document.getElementById('healthScore').textContent = data.healthScore || '-';
                
                // clusterStatusëŠ” ì´ˆê¸°ì—ëŠ” ë¹„ì›Œë‘  (ìƒíƒœ ë¶„ì„ ë²„íŠ¼ í´ë¦­ ì‹œì—ë§Œ í‘œì‹œ)
                const statusDiv = document.getElementById('clusterStatus');
                statusDiv.innerHTML = '';
            } catch (e) {
                console.error('Cluster overview error:', e);
                document.getElementById('healthScore').textContent = '-';
            }
        }
        
        // í´ëŸ¬ìŠ¤í„° í†µê³„ ë¡œë“œ
        async function loadClusterStats() {
            try {
                // ë…¸ë“œ ìˆ˜
                const nodeRes = await fetch(`${API_BASE}/k8s/nodes`);
                const nodeData = await nodeRes.json();
                document.getElementById('totalNodes').textContent = nodeData.nodes?.length || 0;
                
                // Pod ìˆ˜
                const podRes = await fetch(`${API_BASE}/k8s/pods`);
                const podData = await podRes.json();
                const pods = podData.pods || [];
                const totalPods = pods.length;
                const runningPods = pods.filter(p => p.status === 'Running').length;
                
                document.getElementById('totalPods').textContent = totalPods;
                document.getElementById('runningPods').textContent = runningPods;
                
                // Pod ëª©ë¡ ìºì‹œ
                podListCache = pods;
            } catch (e) {
                console.error('Cluster stats error:', e);
                document.getElementById('totalPods').textContent = '-';
                document.getElementById('runningPods').textContent = '-';
            }
        }
        
        // Pod ëª©ë¡ ë¡œë“œ
        async function loadPodList() {
            try {
                if (podListCache) {
                    allPods = podListCache;
                } else {
                    const res = await fetch(`${API_BASE}/k8s/pods`);
                    const data = await res.json();
                    allPods = data.pods || [];
                }
                updatePodDropdown(allPods);
            } catch (e) {
                console.error('Load pod list error:', e);
                allPods = [];
            }
        }
        
        // Pod ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
        function updatePodDropdown(pods) {
            const dropdown = document.getElementById('podDropdown');
            dropdown.innerHTML = '';
            
            if (pods.length === 0) {
                dropdown.innerHTML = '<div class="searchable-select-option">Podê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }
            
                // "ì„ íƒ ì•ˆí•¨" ì˜µì…˜ ì¶”ê°€
                const noneOption = document.createElement('div');
                noneOption.className = 'searchable-select-option' + (selectedPod === null ? ' selected' : '');
                noneOption.textContent = 'Pod ì„ íƒ ì•ˆí•¨';
                noneOption.onclick = () => selectPod(null);
                dropdown.appendChild(noneOption);
            
            pods.forEach(pod => {
                const option = document.createElement('div');
                option.className = 'searchable-select-option' + (selectedPod === pod.name ? ' selected' : '');
                const detailedStatus = pod.detailedStatus || pod.status || 'Unknown';
                const statusInfo = getStatusColor(detailedStatus);
                option.innerHTML = `${pod.namespace}/${pod.name} <span style="color: ${statusInfo.color}; font-weight: 600;">(${detailedStatus})</span>`;
                option.onclick = () => selectPod(pod.name, pod.namespace);
                dropdown.appendChild(option);
            });
        }
        
        // Pod í•„í„°ë§
        function filterPods(searchTerm) {
            const filtered = allPods.filter(pod => {
                const search = searchTerm.toLowerCase();
                return pod.name.toLowerCase().includes(search) || 
                       pod.namespace.toLowerCase().includes(search);
            });
            updatePodDropdown(filtered);
            showPodDropdown();
        }
        
        // ë“œë¡­ë‹¤ìš´ í‘œì‹œ
        function showPodDropdown() {
            document.getElementById('podDropdown').classList.add('show');
        }
        
        // Pod ì„ íƒ
        function selectPod(podName, namespace) {
            selectedPod = podName;
            selectedNamespace = namespace;
            document.getElementById('podSearchInput').value = podName ? `${namespace}/${podName}` : '';
            document.getElementById('podDropdown').classList.remove('show');
            
            // ì„ íƒëœ Pod ì •ë³´ í‘œì‹œ
            const infoDiv = document.getElementById('selectedPodInfo');
            if (podName) {
                const pod = allPods.find(p => p.name === podName && p.namespace === namespace);
                const detailedStatus = pod?.detailedStatus || pod?.status || 'Unknown';
                const statusInfo = getStatusColor(detailedStatus);
                infoDiv.innerHTML = `<span class="selected-pod-badge">ì„ íƒë¨: ${namespace}/${podName} <span style="color: ${statusInfo.color}; font-weight: 600;">(${detailedStatus})</span></span>`;
            } else {
                infoDiv.innerHTML = '<span class="selected-pod-badge" style="background: #9e9e9e;">Podë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</span>';
            }
            
            // ë¦¬ì†ŒìŠ¤ ë°ì´í„° ë‹¤ì‹œ ë¡œë“œ
            loadContainerCpu();
            loadContainerMemory();
            loadPodCpu();
            loadPodMemory();
        }
        
        // í´ë¦­ ì™¸ë¶€ ê°ì§€
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.searchable-select')) {
                document.getElementById('podDropdown').classList.remove('show');
            }
        });
        
        // Container CPU ë¡œë“œ (ê³¼ê±° ë°ì´í„° í¬í•¨)
        async function loadContainerCpu() {
            // Podê°€ ì„ íƒë˜ì§€ ì•Šì•˜ìœ¼ë©´ ë°ì´í„° í‘œì‹œ ì•ˆí•¨
            if (!selectedPod || !selectedNamespace) {
                updateChart('containerCpuChart', { labels: [], values: [] }, 'Container CPU ì‚¬ìš©ë¥  (%)');
                const tbody = document.querySelector('#containerCpuTable tbody');
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #9e9e9e;">Podë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</td></tr>';
                return;
            }
            
            try {
                // í˜„ì¬ ë°ì´í„°
                const res = await fetch(`${API_BASE}/k8s/resources/container/cpu`);
                const data = await res.json();
                
                // ê³¼ê±° ë°ì´í„° (ì‹œê³„ì—´)
                const historyRes = await fetch(`${API_BASE}/k8s/resources/container/cpu/history?pod=${selectedPod}&namespace=${selectedNamespace}&hours=24`);
                let historyData = null;
                if (historyRes.ok) {
                    historyData = await historyRes.json();
                }
                
                // Pod í•„í„°ë§
                let containers = data.containers || [];
                containers = containers.filter(c => c.pod === selectedPod && c.namespace === selectedNamespace);
                
                // ì‹œê³„ì—´ ì°¨íŠ¸ ë°ì´í„° ìƒì„±
                if (historyData && historyData.timeline && historyData.timeline.length > 0) {
                    const timeline = historyData.timeline;
                    const chartData = {
                        labels: timeline.map(t => {
                            const date = new Date(t.timestamp);
                            return date.toLocaleString('ko-KR', { timeZone: 'Asia/Seoul', hour: '2-digit', minute: '2-digit' });
                        }),
                        values: timeline.map(t => t.cpuUsage || 0)
                    };
                    updateTimeSeriesChart('containerCpuChart', chartData, `Container CPU ì‚¬ìš©ë¥  - ${selectedPod} (%)`);
                } else if (containers.length > 0) {
                    // ê³¼ê±° ë°ì´í„°ê°€ ì—†ìœ¼ë©´ í˜„ì¬ ë°ì´í„°ë§Œ í‘œì‹œ
                    const chartData = {
                        labels: data.chartData?.labels || [],
                        values: containers.map(c => c.cpuUsage || 0)
                    };
                    updateChart('containerCpuChart', chartData, `Container CPU ì‚¬ìš©ë¥  - ${selectedPod} (%)`);
                } else {
                    updateChart('containerCpuChart', { labels: [], values: [] }, 'Container CPU ì‚¬ìš©ë¥  (%)');
                }
                
                // í…Œì´ë¸” ì—…ë°ì´íŠ¸
                const tbody = document.querySelector('#containerCpuTable tbody');
                if (containers.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #9e9e9e;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                } else {
                    tbody.innerHTML = containers.map(c => `
                        <tr>
                            <td>${escapeHtml(c.namespace || '')}</td>
                            <td>${escapeHtml(c.pod || '')}</td>
                            <td>${escapeHtml(c.container || '')}</td>
                            <td>${(c.cpuUsage || 0).toFixed(2)}%</td>
                            <td>${c.cpuLimit || 'N/A'}</td>
                        </tr>
                    `).join('');
                }
            } catch (e) {
                console.error('Container CPU error:', e);
            }
        }
        
        // Container Memory ë¡œë“œ (ê³¼ê±° ë°ì´í„° í¬í•¨)
        async function loadContainerMemory() {
            if (!selectedPod || !selectedNamespace) {
                updateChart('containerMemoryChart', { labels: [], values: [] }, 'Container Memory ì‚¬ìš©ëŸ‰ (Mi)');
                const tbody = document.querySelector('#containerMemoryTable tbody');
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #9e9e9e;">Podë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</td></tr>';
                return;
            }
            
            try {
                const res = await fetch(`${API_BASE}/k8s/resources/container/memory`);
                const data = await res.json();
                
                // ê³¼ê±° ë°ì´í„°
                const historyRes = await fetch(`${API_BASE}/k8s/resources/container/memory/history?pod=${selectedPod}&namespace=${selectedNamespace}&hours=24`);
                let historyData = null;
                if (historyRes.ok) {
                    historyData = await historyRes.json();
                }
                
                let containers = data.containers || [];
                containers = containers.filter(c => c.pod === selectedPod && c.namespace === selectedNamespace);
                
                if (historyData && historyData.timeline && historyData.timeline.length > 0) {
                    const timeline = historyData.timeline;
                    const chartData = {
                        labels: timeline.map(t => {
                            const date = new Date(t.timestamp);
                            return date.toLocaleString('ko-KR', { timeZone: 'Asia/Seoul', hour: '2-digit', minute: '2-digit' });
                        }),
                        values: timeline.map(t => t.memoryUsage || 0)
                    };
                    updateTimeSeriesChart('containerMemoryChart', chartData, `Container Memory ì‚¬ìš©ëŸ‰ - ${selectedPod} (Mi)`);
                } else if (containers.length > 0) {
                    const chartData = {
                        labels: data.chartData?.labels || [],
                        values: containers.map(c => c.memoryUsage || 0)
                    };
                    updateChart('containerMemoryChart', chartData, `Container Memory ì‚¬ìš©ëŸ‰ - ${selectedPod} (Mi)`);
                } else {
                    updateChart('containerMemoryChart', { labels: [], values: [] }, 'Container Memory ì‚¬ìš©ëŸ‰ (Mi)');
                }
                
                const tbody = document.querySelector('#containerMemoryTable tbody');
                if (containers.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #9e9e9e;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                } else {
                    tbody.innerHTML = containers.map(c => `
                        <tr>
                            <td>${escapeHtml(c.namespace || '')}</td>
                            <td>${escapeHtml(c.pod || '')}</td>
                            <td>${escapeHtml(c.container || '')}</td>
                            <td>${(c.memoryUsage || 0).toFixed(2)} Mi</td>
                            <td>${c.memoryLimit || 'N/A'}</td>
                        </tr>
                    `).join('');
                }
            } catch (e) {
                console.error('Container Memory error:', e);
            }
        }
        
        // Pod CPU ë¡œë“œ (ê³¼ê±° ë°ì´í„° í¬í•¨)
        async function loadPodCpu() {
            if (!selectedPod || !selectedNamespace) {
                updateChart('podCpuChart', { labels: [], values: [] }, 'Pod CPU ì‚¬ìš©ë¥  (%)');
                const tbody = document.querySelector('#podCpuTable tbody');
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #9e9e9e;">Podë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</td></tr>';
                return;
            }
            
            try {
                const res = await fetch(`${API_BASE}/k8s/resources/pod/cpu`);
                const data = await res.json();
                
                const historyRes = await fetch(`${API_BASE}/k8s/resources/pod/cpu/history?pod=${selectedPod}&namespace=${selectedNamespace}&hours=24`);
                let historyData = null;
                if (historyRes.ok) {
                    historyData = await historyRes.json();
                }
                
                let pods = data.pods || [];
                pods = pods.filter(p => p.pod === selectedPod && p.namespace === selectedNamespace);
                
                if (historyData && historyData.timeline && historyData.timeline.length > 0) {
                    const timeline = historyData.timeline;
                    const chartData = {
                        labels: timeline.map(t => {
                            const date = new Date(t.timestamp);
                            return date.toLocaleString('ko-KR', { timeZone: 'Asia/Seoul', hour: '2-digit', minute: '2-digit' });
                        }),
                        values: timeline.map(t => t.cpuUsage || 0)
                    };
                    updateTimeSeriesChart('podCpuChart', chartData, `Pod CPU ì‚¬ìš©ë¥  - ${selectedPod} (%)`);
                } else if (pods.length > 0) {
                    const chartData = {
                        labels: data.chartData?.labels || [],
                        values: pods.map(p => p.cpuUsage || 0)
                    };
                    updateChart('podCpuChart', chartData, `Pod CPU ì‚¬ìš©ë¥  - ${selectedPod} (%)`);
                } else {
                    updateChart('podCpuChart', { labels: [], values: [] }, 'Pod CPU ì‚¬ìš©ë¥  (%)');
                }
                
                const tbody = document.querySelector('#podCpuTable tbody');
                if (pods.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #9e9e9e;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                } else {
                    tbody.innerHTML = pods.map(p => `
                        <tr>
                            <td>${escapeHtml(p.namespace || '')}</td>
                            <td>${escapeHtml(p.pod || '')}</td>
                            <td>${(p.cpuUsage || 0).toFixed(2)}%</td>
                            <td>${p.cpuRequest || 'N/A'}</td>
                            <td>${p.cpuLimit || 'N/A'}</td>
                        </tr>
                    `).join('');
                }
            } catch (e) {
                console.error('Pod CPU error:', e);
            }
        }
        
        // Pod Memory ë¡œë“œ (ê³¼ê±° ë°ì´í„° í¬í•¨)
        async function loadPodMemory() {
            if (!selectedPod || !selectedNamespace) {
                updateChart('podMemoryChart', { labels: [], values: [] }, 'Pod Memory ì‚¬ìš©ëŸ‰ (Mi)');
                const tbody = document.querySelector('#podMemoryTable tbody');
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #9e9e9e;">Podë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</td></tr>';
                return;
            }
            
            try {
                const res = await fetch(`${API_BASE}/k8s/resources/pod/memory`);
                const data = await res.json();
                
                const historyRes = await fetch(`${API_BASE}/k8s/resources/pod/memory/history?pod=${selectedPod}&namespace=${selectedNamespace}&hours=24`);
                let historyData = null;
                if (historyRes.ok) {
                    historyData = await historyRes.json();
                }
                
                let pods = data.pods || [];
                pods = pods.filter(p => p.pod === selectedPod && p.namespace === selectedNamespace);
                
                if (historyData && historyData.timeline && historyData.timeline.length > 0) {
                    const timeline = historyData.timeline;
                    const chartData = {
                        labels: timeline.map(t => {
                            const date = new Date(t.timestamp);
                            return date.toLocaleString('ko-KR', { timeZone: 'Asia/Seoul', hour: '2-digit', minute: '2-digit' });
                        }),
                        values: timeline.map(t => t.memoryUsage || 0)
                    };
                    updateTimeSeriesChart('podMemoryChart', chartData, `Pod Memory ì‚¬ìš©ëŸ‰ - ${selectedPod} (Mi)`);
                } else if (pods.length > 0) {
                    const chartData = {
                        labels: data.chartData?.labels || [],
                        values: pods.map(p => p.memoryUsage || 0)
                    };
                    updateChart('podMemoryChart', chartData, `Pod Memory ì‚¬ìš©ëŸ‰ - ${selectedPod} (Mi)`);
                } else {
                    updateChart('podMemoryChart', { labels: [], values: [] }, 'Pod Memory ì‚¬ìš©ëŸ‰ (Mi)');
                }
                
                const tbody = document.querySelector('#podMemoryTable tbody');
                if (pods.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #9e9e9e;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                } else {
                    tbody.innerHTML = pods.map(p => `
                        <tr>
                            <td>${escapeHtml(p.namespace || '')}</td>
                            <td>${escapeHtml(p.pod || '')}</td>
                            <td>${(p.memoryUsage || 0).toFixed(2)} Mi</td>
                            <td>${p.memoryRequest || 'N/A'}</td>
                            <td>${p.memoryLimit || 'N/A'}</td>
                        </tr>
                    `).join('');
                }
            } catch (e) {
                console.error('Pod Memory error:', e);
            }
        }
        
        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateChart(canvasId, data, label) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            if (charts[canvasId]) {
                charts[canvasId].destroy();
            }
            
            charts[canvasId] = new Chart(canvas, {
                type: 'line',
                data: {
                    labels: data?.labels || [],
                    datasets: [{
                        label: label,
                        data: data?.values || [],
                        borderColor: '#3274d9',
                        backgroundColor: 'rgba(50, 116, 217, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#d8d9da' } }
                    },
                    scales: {
                        y: { ticks: { color: '#9e9e9e' }, grid: { color: '#3d3d42' } },
                        x: { ticks: { color: '#9e9e9e' }, grid: { color: '#3d3d42' } }
                    }
                }
            });
        }
        
        // ì‹œê³„ì—´ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (ê³¼ê±° ë°ì´í„°)
        function updateTimeSeriesChart(canvasId, data, label) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            if (charts[canvasId]) {
                charts[canvasId].destroy();
            }
            
            charts[canvasId] = new Chart(canvas, {
                type: 'line',
                data: {
                    labels: data?.labels || [],
                    datasets: [{
                        label: label,
                        data: data?.values || [],
                        borderColor: '#3274d9',
                        backgroundColor: 'rgba(50, 116, 217, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#d8d9da' } },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return context[0].label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: { 
                            ticks: { color: '#9e9e9e' }, 
                            grid: { color: '#3d3d42' },
                            beginAtZero: true
                        },
                        x: { 
                            ticks: { 
                                color: '#9e9e9e',
                                maxRotation: 45,
                                minRotation: 45
                            }, 
                            grid: { color: '#3d3d42' } 
                        }
                    }
                }
            });
        }
        
        // K8s ìƒíƒœ ì²´í¬ (ìƒíƒœ ë¶„ì„ ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰)
        async function checkK8sStatus() {
            const statusDiv = document.getElementById('clusterStatus');
            statusDiv.innerHTML = '<div class="loading"></div> ìƒíƒœ ë¶„ì„ ì¤‘...';
            
            try {
                const res = await fetch(`${API_BASE}/k8s/status`);
                const data = await res.json();
                
                // ê±´ê°• ì ìˆ˜ë„ ì—…ë°ì´íŠ¸
                document.getElementById('healthScore').textContent = data.healthScore || '-';
                
                let html = `
                    <div style="margin-top: 16px;">
                        <div style="font-size: 24px; font-weight: 600; color: ${data.status === 'healthy' ? '#73bf69' : data.status === 'warning' ? '#fdd835' : '#e57373'};">
                            ê±´ê°• ì ìˆ˜: ${data.healthScore}/100
                        </div>
                        <div style="margin-top: 12px;">
                            Critical: ${data.criticalCount || 0} | Warning: ${data.warningCount || 0}
                        </div>
                `;
                
                if (data.aiAnalysis) {
                    html += `
                        <div class="analysis-result" style="margin-top: 16px;">
                            <h3>AI ë¶„ì„</h3>
                            <div class="analysis-text">${safeHtml(data.aiAnalysis)}</div>
                        </div>
                    `;
                }
                
                html += '</div>';
                statusDiv.innerHTML = html;
            } catch (e) {
                statusDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
            }
        }
        
        // íŒŒë“œ ë¶„ì„
        async function analyzePod() {
            const podName = document.getElementById('podAnalysisName').value.trim();
            const namespace = document.getElementById('podAnalysisNamespace').value.trim() || 'default';
            
            if (!podName) {
                alert('Pod ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const statusDiv = document.getElementById('podAnalysisStatus');
            const resultDiv = document.getElementById('podAnalysisResult');
            
            statusDiv.innerHTML = '<div class="loading"></div> Pod ì •ë³´ ìˆ˜ì§‘ ì¤‘... (kubectl describe & logs ì‹¤í–‰)';
            resultDiv.classList.add('hidden');
            
            try {
                const res = await fetch(`${API_BASE}/analyze/pod`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        podName,
                        namespace
                    })
                });
                
                const data = await res.json();
                
                if (data.error) {
                    statusDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${data.error}</div>`;
                    return;
                }
                
                statusDiv.innerHTML = '<div class="status success">âœ… ë¶„ì„ ì™„ë£Œ</div>';
                
                // Pod ì •ë³´ í‘œì‹œ
                let resultHtml = `
                    <div class="analysis-result" style="margin-top: 16px;">
                        <h3>Pod ì •ë³´</h3>
                        <div style="background: #1f1f23; padding: 16px; border-radius: 4px; margin-bottom: 16px;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                                <div><strong>ì´ë¦„:</strong> ${escapeHtml(podName)}</div>
                                <div><strong>ë„¤ì„ìŠ¤í˜ì´ìŠ¤:</strong> ${escapeHtml(namespace)}</div>
                                <div><strong>ìƒíƒœ:</strong> ${(() => {
                                    const podStatus = data.podInfo?.detailedStatus || data.status || 'Unknown';
                                    const statusInfo = getStatusColor(podStatus);
                                    return `<span class="status ${statusInfo.class}" style="padding: 4px 8px; font-size: 12px; background: ${statusInfo.color}; color: white; border-radius: 4px; font-weight: 600;">${escapeHtml(podStatus)}</span>`;
                                })()}</div>
                                <div><strong>ë…¸ë“œ:</strong> ${escapeHtml(data.podInfo?.node || 'N/A')}</div>
                            </div>
                        </div>
                `;
                
                // ë¬¸ì œì  í‘œì‹œ
                if (data.issues && data.issues.length > 0) {
                    resultHtml += `
                        <h3 style="margin-top: 16px; color: #e57373;">âš ï¸ ë°œê²¬ëœ ë¬¸ì œ</h3>
                        <ul style="background: #1f1f23; padding: 16px; border-radius: 4px; border-left: 3px solid #e57373;">
                            ${data.issues.map(issue => `<li style="margin: 8px 0;">${escapeHtml(issue)}</li>`).join('')}
                        </ul>
                    `;
                }
                
                // AI ë¶„ì„ ê²°ê³¼
                if (data.analysis) {
                    resultHtml += `
                        <h3 style="margin-top: 24px;">ğŸ¤– AI ë¶„ì„ ê²°ê³¼</h3>
                        <div class="analysis-text">${safeHtml(data.analysis)}</div>
                    `;
                }
                
                resultHtml += '</div>';
                resultDiv.innerHTML = resultHtml;
                resultDiv.classList.remove('hidden');
                
                // í•´ë‹¹ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                scrollToSection('section-pod-analysis');
            } catch (e) {
                statusDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
                console.error('Pod analysis error:', e);
            }
        }
        
        // ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                // ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™”
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelectorAll('.nav-item').forEach(item => {
                    if (item.getAttribute('onclick')?.includes(sectionId)) {
                        item.classList.add('active');
                    }
                });
                
                // ìŠ¤í¬ë¡¤
                const headerHeight = 80;
                const navHeight = 0;
                const offset = section.offsetTop - headerHeight - navHeight - 20;
                window.scrollTo({
                    top: offset,
                    behavior: 'smooth'
                });
                
                // ì„¹ì…˜ í‘œì‹œ ë° ë°ì´í„° ë¡œë“œ
                if (!section.classList.contains('visible')) {
                    section.classList.add('visible');
                    const sectionIdOnly = sectionId.replace('section-', '');
                    if (!loadedSections.has(sectionId)) {
                        loadSectionData(sectionId);
                        loadedSections.add(sectionId);
                    }
                }
            }
        }
        
        // ìƒíƒœë³„ ìƒ‰ìƒ ë° ë¶„ë¥˜ í•¨ìˆ˜
        function getStatusColor(status) {
            const statusLower = (status || '').toLowerCase();
            
            // ì •ìƒ ìƒíƒœ (ì´ˆë¡ìƒ‰)
            if (statusLower === 'running' || statusLower === 'succeeded' || statusLower === 'completed') {
                return { color: '#73bf69', class: 'success', label: 'ì •ìƒ' };
            }
            
            // ì§„í–‰ ì¤‘/ëŒ€ê¸° ìƒíƒœ (ë…¸ë€ìƒ‰)
            if (statusLower === 'pending' || 
                statusLower === 'containercreating' || 
                statusLower === 'podinitializing' ||
                statusLower === 'terminating') {
                return { color: '#fdd835', class: 'warning', label: 'ì§„í–‰ ì¤‘' };
            }
            
            // ì´ë¯¸ì§€/ì„¤ì • ì˜¤ë¥˜ (ì£¼í™©ìƒ‰)
            if (statusLower.includes('imagepull') || 
                statusLower.includes('errimagepull') ||
                statusLower.includes('createcontainerconfigerror') ||
                statusLower.includes('invalidimagename')) {
                return { color: '#ff9800', class: 'error', label: 'ì´ë¯¸ì§€ ì˜¤ë¥˜' };
            }
            
            // ëŸ°íƒ€ì„/ë¦¬ì†ŒìŠ¤ ì˜¤ë¥˜ (ë¹¨ê°„ìƒ‰)
            if (statusLower.includes('crashloopbackoff') ||
                statusLower.includes('oomkilled') ||
                statusLower.includes('error') ||
                statusLower.includes('evicted') ||
                statusLower === 'failed' ||
                statusLower === 'unknown' ||
                statusLower.includes('unschedulable')) {
                return { color: '#e57373', class: 'error', label: 'ì˜¤ë¥˜' };
            }
            
            // ê¸°ë³¸ê°’ (íšŒìƒ‰)
            return { color: '#9e9e9e', class: 'warning', label: 'ì•Œ ìˆ˜ ì—†ìŒ' };
        }

        // Pod ìƒíƒœ ëª¨ë‹ˆí„°ë§
        async function loadPodStatus() {
            const summaryDiv = document.getElementById('podStatusSummary');
            const detailsDiv = document.getElementById('podStatusDetails');
            
            summaryDiv.innerHTML = '<div class="loading"></div> ë¡œë”© ì¤‘...';
            detailsDiv.innerHTML = '';
            
            try {
                const res = await fetch(`${API_BASE}/k8s/pods`);
                const data = await res.json();
                const pods = data.pods || [];
                
                // ë…¸ë“œ í•„í„°ë§
                const selectedNode = document.getElementById('nodeSelector')?.value;
                let filteredPods = pods;
                if (selectedNode && selectedNode !== 'all') {
                    filteredPods = pods.filter(pod => pod.node === selectedNode);
                }
                
                // ìƒíƒœë³„ ì§‘ê³„ (ìƒì„¸ ìƒíƒœ ì‚¬ìš©)
                const statusCount = {};
                filteredPods.forEach(pod => {
                    const status = pod.detailedStatus || pod.status || 'Unknown';
                    statusCount[status] = (statusCount[status] || 0) + 1;
                });
                
                // ìš”ì•½ ì¹´ë“œ (ìƒì„¸ ìƒíƒœë³„ë¡œ í‘œì‹œ)
                summaryDiv.innerHTML = Object.entries(statusCount)
                    .sort((a, b) => {
                        // ì‹¬ê°ë„ ìˆœìœ¼ë¡œ ì •ë ¬ (ì—ëŸ¬ > ê²½ê³  > ì •ìƒ)
                        const aInfo = getStatusColor(a[0]);
                        const bInfo = getStatusColor(b[0]);
                        const severity = { 'error': 3, 'warning': 2, 'success': 1 };
                        return (severity[bInfo.class] || 0) - (severity[aInfo.class] || 0);
                    })
                    .map(([status, count]) => {
                        const statusInfo = getStatusColor(status);
                        return `
                            <div class="metric-card" style="border-left: 4px solid ${statusInfo.color};">
                                <div class="metric-label" style="font-size: 12px; color: #9e9e9e;">${statusInfo.label}</div>
                                <div class="metric-value" style="color: ${statusInfo.color}; font-size: 24px; font-weight: 600;">${count}</div>
                                <div style="font-size: 11px; color: #9e9e9e; margin-top: 4px;">${status}</div>
                            </div>
                        `;
                    }).join('');
                
                // ìƒì„¸ í…Œì´ë¸”
                if (filteredPods.length > 0) {
                    detailsDiv.innerHTML = `
                        <h3 style="margin-bottom: 16px;">Pod ìƒì„¸ ëª©ë¡ ${selectedNode && selectedNode !== 'all' ? `(ë…¸ë“œ: ${selectedNode})` : ''}</h3>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ë„¤ì„ìŠ¤í˜ì´ìŠ¤</th>
                                        <th>Pod ì´ë¦„</th>
                                        <th>ìƒíƒœ</th>
                                        <th>ìƒì„¸ ì •ë³´</th>
                                        <th>ì¬ì‹œì‘</th>
                                        <th>ë…¸ë“œ</th>
                                        <th>ìƒì„± ì‹œê°„</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${filteredPods.map(pod => {
                                        const detailedStatus = pod.detailedStatus || pod.status || 'Unknown';
                                        const statusInfo = getStatusColor(detailedStatus);
                                        const statusMessage = pod.statusMessage || pod.statusReason || '';
                                        
                                        return `
                                            <tr>
                                                <td>${escapeHtml(pod.namespace || '')}</td>
                                                <td><strong>${escapeHtml(pod.name || '')}</strong></td>
                                                <td>
                                                    <span class="status ${statusInfo.class}" style="padding: 4px 8px; font-size: 12px; background: ${statusInfo.color}; color: white; border-radius: 4px; font-weight: 600;">
                                                        ${escapeHtml(detailedStatus)}
                                                    </span>
                                                </td>
                                                <td style="font-size: 11px; color: #9e9e9e; max-width: 300px;">
                                                    ${statusMessage ? 
                                                        `<div title="${escapeHtml(statusMessage)}">${escapeHtml(statusMessage.substring(0, 60))}${statusMessage.length > 60 ? '...' : ''}</div>` : 
                                                        '<span style="color: #666;">-</span>'
                                                    }
                                                </td>
                                                <td style="text-align: center;">
                                                    ${pod.restartCount > 0 ? 
                                                        `<span style="color: #e57373; font-weight: 600;">${pod.restartCount}</span>` : 
                                                        '<span style="color: #9e9e9e;">0</span>'
                                                    }
                                                </td>
                                                <td>${escapeHtml(pod.node || 'N/A')}</td>
                                                <td style="font-size: 11px;">${new Date(pod.createdAt).toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' })}</td>
                                            </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                } else {
                    detailsDiv.innerHTML = '<div class="status warning">Podê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                }
            } catch (e) {
                summaryDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
                detailsDiv.innerHTML = '';
            }
        }
        
        // ì„±ëŠ¥ ë©”íŠ¸ë¦­ ë¡œë“œ
        async function loadPerformanceMetrics() {
            await Promise.all([
                loadLatency(),
                loadErrorRate(),
                loadThroughput(),
                loadRequestsPerSecond()
            ]);
        }
        
        // Latency ë¡œë“œ
        async function loadLatency() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/latency`);
                const data = await res.json();
                
                const latencyValue = data.value || '0';
                document.getElementById('latencyValue').textContent = `${latencyValue} ${data.unit || 'ms'}`;
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // ì ˆëŒ€ê°’ ë³€í™” ë˜ëŠ” ìƒëŒ€ í¼ì„¼íŠ¸ ë³€í™” ì¤‘ í•˜ë‚˜ë¼ë„ ì„ê³„ê°’ì„ ë„˜ìœ¼ë©´ ë³€í™”ë¡œ í‘œì‹œ
                    // Latency: ì ˆëŒ€ê°’ 0.001 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 0.1% ì´ìƒ
                    const threshold = 0.001; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 0.1; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - LatencyëŠ” ì¦ê°€í•˜ë©´ ë‚˜ì¨)
                            trendText = `+${absTrendPercent.toFixed(2)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - LatencyëŠ” ê°ì†Œí•˜ë©´ ì¢‹ìŒ)
                            trendText = `${absTrendPercent.toFixed(2)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('latencyTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('latencyTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Latency error:', e);
                document.getElementById('latencyValue').textContent = '-';
            }
        }
        
        // Error rate ë¡œë“œ
        async function loadErrorRate() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/error-rate`);
                const data = await res.json();
                
                const errorRateValue = data.value || '0';
                document.getElementById('errorRateValue').textContent = `${errorRateValue} ${data.unit || '%'}`;
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // Error rate: ì ˆëŒ€ê°’ 0.0001 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 0.01% ì´ìƒ (ë§¤ìš° ì‘ì€ ë³€í™”ë„ ê°ì§€)
                    const threshold = 0.0001; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 0.01; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - Error rate ì¦ê°€ëŠ” ë‚˜ì¨)
                            trendText = `+${absTrendPercent.toFixed(3)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - Error rate ê°ì†ŒëŠ” ì¢‹ìŒ)
                            trendText = `${absTrendPercent.toFixed(3)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('errorRateTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('errorRateTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Error rate error:', e);
                document.getElementById('errorRateValue').textContent = '-';
            }
        }
        
        // Throughput ë¡œë“œ
        async function loadThroughput() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/throughput`);
                const data = await res.json();
                
                const throughputValue = data.value || '0';
                document.getElementById('throughputValue').textContent = `${throughputValue} ${data.unit || 'req/s'}`;
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // Throughput: ì ˆëŒ€ê°’ 0.001 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 0.1% ì´ìƒ
                    const threshold = 0.001; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 0.1; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - Throughput ì¦ê°€ëŠ” ì¢‹ìŒ)
                            trendText = `+${absTrendPercent.toFixed(2)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - Throughput ê°ì†ŒëŠ” ë‚˜ì¨)
                            trendText = `${absTrendPercent.toFixed(2)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('throughputTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('throughputTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Throughput error:', e);
                document.getElementById('throughputValue').textContent = '-';
            }
        }
        
        // Requests per second ë¡œë“œ
        async function loadRequestsPerSecond() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/requests-per-second`);
                const data = await res.json();
                
                const rpsValue = data.value || '0';
                document.getElementById('rpsValue').textContent = `${rpsValue} ${data.unit || 'req/s'}`;
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // Reqs/sec: ì ˆëŒ€ê°’ 0.01 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 0.1% ì´ìƒ
                    const threshold = 0.01; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 0.1; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - Reqs/sec ì¦ê°€ëŠ” ì¢‹ìŒ)
                            trendText = `+${absTrendPercent.toFixed(2)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - Reqs/sec ê°ì†ŒëŠ” ë‚˜ì¨)
                            trendText = `${absTrendPercent.toFixed(2)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('rpsTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('rpsTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Requests per second error:', e);
                document.getElementById('rpsValue').textContent = '-';
            }
        }
        
        // ì‹œìŠ¤í…œ ë¶€í•˜ ë©”íŠ¸ë¦­ ë¡œë“œ
        async function loadSystemLoadMetrics() {
            await Promise.all([
                loadSaturation(),
                loadQueueDepth(),
                loadLoad()
            ]);
        }
        
        // Saturation ë¡œë“œ
        async function loadSaturation() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/saturation`);
                const data = await res.json();
                
                const saturationValue = data.value || '0';
                document.getElementById('saturationValue').textContent = `${saturationValue} ${data.unit || '%'}`;
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // Saturation: ì ˆëŒ€ê°’ 0.1 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 0.1% ì´ìƒ
                    const threshold = 0.1; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 0.1; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - Saturation ì¦ê°€ëŠ” ë‚˜ì¨)
                            trendText = `+${absTrendPercent.toFixed(2)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - Saturation ê°ì†ŒëŠ” ì¢‹ìŒ)
                            trendText = `${absTrendPercent.toFixed(2)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('saturationTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('saturationTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Saturation error:', e);
                document.getElementById('saturationValue').textContent = '-';
            }
        }
        
        // Queue depth ë¡œë“œ
        async function loadQueueDepth() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/queue-depth`);
                const data = await res.json();
                
                const queueDepthValue = data.value || '0';
                document.getElementById('queueDepthValue').textContent = `${queueDepthValue} ${data.unit || 'pods'}`;
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // Queue depth: ì ˆëŒ€ê°’ 0.1 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 1% ì´ìƒ
                    const threshold = 0.1; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 1; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - Queue depth ì¦ê°€ëŠ” ë‚˜ì¨)
                            trendText = `+${absTrendPercent.toFixed(2)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - Queue depth ê°ì†ŒëŠ” ì¢‹ìŒ)
                            trendText = `${absTrendPercent.toFixed(2)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('queueDepthTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('queueDepthTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Queue depth error:', e);
                document.getElementById('queueDepthValue').textContent = '-';
            }
        }
        
        // Load ë¡œë“œ
        async function loadLoad() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/load`);
                const data = await res.json();
                
                const loadValue = data.value || '0';
                document.getElementById('loadValue').textContent = `${loadValue} ${data.unit || ''}`;
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // Load: ì ˆëŒ€ê°’ 0.01 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 0.1% ì´ìƒ
                    const threshold = 0.01; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 0.1; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - Load ì¦ê°€ëŠ” ë‚˜ì¨)
                            trendText = `+${absTrendPercent.toFixed(2)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - Load ê°ì†ŒëŠ” ì¢‹ìŒ)
                            trendText = `${absTrendPercent.toFixed(2)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('loadTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('loadTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Load error:', e);
                document.getElementById('loadValue').textContent = '-';
            }
        }
        
        // ê°€ìš©ì„± ë° ì˜ˆì‚° ë©”íŠ¸ë¦­ ë¡œë“œ
        async function loadAvailabilityBudgetMetrics() {
            await Promise.all([
                loadAvailability(),
                loadErrorBudget()
            ]);
        }
        
        // Availability ë¡œë“œ
        async function loadAvailability() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/availability`);
                const data = await res.json();
                
                const availabilityValue = data.value || '100';
                document.getElementById('availabilityValue').textContent = `${availabilityValue} ${data.unit || '%'}`;
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // Availability: ì ˆëŒ€ê°’ 0.01 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 0.01% ì´ìƒ
                    const threshold = 0.01; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 0.01; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - Availability ì¦ê°€ëŠ” ì¢‹ìŒ)
                            trendText = `+${absTrendPercent.toFixed(2)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - Availability ê°ì†ŒëŠ” ë‚˜ì¨)
                            trendText = `${absTrendPercent.toFixed(2)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('availabilityTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('availabilityTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Availability error:', e);
                document.getElementById('availabilityValue').textContent = '-';
            }
        }
        
        // Error budget ë¡œë“œ
        async function loadErrorBudget() {
            try {
                const res = await fetch(`${API_BASE}/k8s/metrics/error-budget`);
                const data = await res.json();
                
                const errorBudgetValue = data.value || '0';
                document.getElementById('errorBudgetValue').textContent = `${errorBudgetValue} ${data.unit || '%'}`;
                
                // ë¶„ ë‹¨ìœ„ í‘œì‹œ
                if (data.minutes !== undefined) {
                    document.getElementById('errorBudgetMinutes').textContent = `(${data.minutes}ë¶„)`;
                } else {
                    document.getElementById('errorBudgetMinutes').textContent = '';
                }
                
                // SLO ì •ë³´ í‘œì‹œ (ì„ íƒì‚¬í•­)
                if (data.sloTarget && data.currentAvailability) {
                    const sloInfo = `SLO: ${data.sloTarget}% | í˜„ì¬: ${data.currentAvailability}%`;
                    // í•„ìš”ì‹œ ì¶”ê°€ ì •ë³´ í‘œì‹œ
                }
                
                // ì¶”ì„¸ ê³„ì‚° (ê°œì„ ëœ í™”ì‚´í‘œ + ìƒ‰ìƒ, ì‘ì€ ë³€í™”ë„ ê°ì§€)
                if (data.timeline && data.timeline.length >= 2) {
                    const recent = data.timeline.slice(-2);
                    const trend = recent[1].value - recent[0].value;
                    const trendPercent = recent[0].value > 0 ? ((trend / recent[0].value) * 100) : 0;
                    const absTrendPercent = Math.abs(trendPercent);
                    
                    // Error budget: ì ˆëŒ€ê°’ 0.001 ì´ìƒ ë˜ëŠ” ìƒëŒ€ 0.1% ì´ìƒ
                    const threshold = 0.001; // ì ˆëŒ€ê°’ ì„ê³„ê°’
                    const percentThreshold = 0.1; // ìƒëŒ€ í¼ì„¼íŠ¸ ì„ê³„ê°’
                    
                    let trendIcon, trendColor, trendText;
                    if (Math.abs(trend) > threshold || absTrendPercent > percentThreshold) {
                        if (trend > 0) {
                            trendIcon = 'â†‘';
                            trendColor = '#e57373'; // ë¹¨ê°„ìƒ‰ (ë‚˜ì¨ - Error budget ì¦ê°€ëŠ” ë‚˜ì¨)
                            trendText = `+${absTrendPercent.toFixed(3)}%`;
                        } else {
                            trendIcon = 'â†“';
                            trendColor = '#73bf69'; // ì´ˆë¡ìƒ‰ (ì¢‹ìŒ - Error budget ê°ì†ŒëŠ” ì¢‹ìŒ)
                            trendText = `${absTrendPercent.toFixed(3)}%`;
                        }
                    } else {
                        trendIcon = 'â†’';
                        trendColor = '#9e9e9e'; // íšŒìƒ‰ (ë³€í™” ì—†ìŒ)
                        trendText = '0%';
                    }
                    
                    document.getElementById('errorBudgetTrend').innerHTML = 
                        `<span style="color: ${trendColor}; font-weight: 500;">${trendIcon} ${trendText}</span>`;
                } else {
                    document.getElementById('errorBudgetTrend').innerHTML = 
                        `<span style="color: #9e9e9e;">â†’ 0%</span>`;
                }
            } catch (e) {
                console.error('Error budget error:', e);
                document.getElementById('errorBudgetValue').textContent = '-';
            }
        }
        
        // ì¡°ê¸° ê²½ê³  ë¡œë“œ
        async function loadEarlyWarning() {
            const summaryDiv = document.getElementById('earlyWarningSummary');
            const alertsDiv = document.getElementById('earlyWarningList');
            
            summaryDiv.innerHTML = '<div class="loading"></div> ë¡œë”© ì¤‘...';
            alertsDiv.innerHTML = '<div class="loading"></div> ë¡œë”© ì¤‘...';
            
            try {
                const res = await fetch(`${API_BASE}/k8s/alerts/early-warning`);
                const data = await res.json();
                const alerts = data.alerts || [];
                
                // ìš”ì•½ ì¹´ë“œ
                summaryDiv.innerHTML = `
                    <div class="metric-card" style="padding: 20px; text-align: center;">
                        <div class="metric-label" style="font-size: 14px; color: #9e9e9e; margin-bottom: 8px;">ì „ì²´ ì•Œë¦¼</div>
                        <div class="metric-value" style="font-size: 32px; font-weight: 600; color: #3274d9;">${data.total || 0}</div>
                    </div>
                    <div class="metric-card" style="padding: 20px; text-align: center;">
                        <div class="metric-label" style="font-size: 14px; color: #9e9e9e; margin-bottom: 8px;">Critical</div>
                        <div class="metric-value" style="font-size: 32px; font-weight: 600; color: #e57373;">${data.critical || 0}</div>
                    </div>
                    <div class="metric-card" style="padding: 20px; text-align: center;">
                        <div class="metric-label" style="font-size: 14px; color: #9e9e9e; margin-bottom: 8px;">Warning</div>
                        <div class="metric-value" style="font-size: 32px; font-weight: 600; color: #fdd835;">${data.warning || 0}</div>
                    </div>
                    <div class="metric-card" style="padding: 20px; text-align: center;">
                        <div class="metric-label" style="font-size: 14px; color: #9e9e9e; margin-bottom: 8px;">Info</div>
                        <div class="metric-value" style="font-size: 32px; font-weight: 600; color: #9e9e9e;">${data.info || 0}</div>
                    </div>
                `;
                
                // ì•Œë¦¼ ëª©ë¡
                if (alerts.length === 0) {
                    alertsDiv.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #9e9e9e;">
                            <div style="font-size: 48px; margin-bottom: 16px;">âœ…</div>
                            <div style="font-size: 16px;">í˜„ì¬ ì´ìƒ ì§•í›„ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
                        </div>
                    `;
                } else {
                    alertsDiv.innerHTML = alerts.map((alert, index) => {
                        const severityColor = {
                            'critical': '#e57373',
                            'warning': '#fdd835',
                            'info': '#9e9e9e'
                        }[alert.severity] || '#9e9e9e';
                        
                        const severityBg = {
                            'critical': 'rgba(229, 115, 115, 0.1)',
                            'warning': 'rgba(253, 216, 53, 0.1)',
                            'info': 'rgba(158, 158, 158, 0.1)'
                        }[alert.severity] || 'rgba(158, 158, 158, 0.1)';
                        
                        const severityIcon = {
                            'critical': 'ğŸš¨',
                            'warning': 'âš ï¸',
                            'info': 'â„¹ï¸'
                        }[alert.severity] || 'â„¹ï¸';
                        
                        return `
                            <div class="alert-card" data-alert-index="${index}" style="
                                border-left: 4px solid ${severityColor};
                                background: ${severityBg};
                                padding: 16px;
                                border-radius: 4px;
                                cursor: pointer;
                                transition: all 0.2s;
                            " onclick="showAlertDetails(${index}, ${JSON.stringify(alert).replace(/"/g, '&quot;')})">
                                <div style="display: flex; align-items: start; gap: 12px;">
                                    <div style="font-size: 24px;">${severityIcon}</div>
                                    <div style="flex: 1;">
                                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                            <span style="
                                                background: ${severityColor};
                                                color: #fff;
                                                padding: 2px 8px;
                                                border-radius: 4px;
                                                font-size: 11px;
                                                font-weight: 600;
                                                text-transform: uppercase;
                                            ">${alert.severity || 'info'}</span>
                                            <span style="font-weight: 600; color: #d8d9da;">${escapeHtml(alert.metric || 'ì•Œ ìˆ˜ ì—†ìŒ')}</span>
                                        </div>
                                        <div style="color: #d8d9da; margin-bottom: 4px;">${escapeHtml(alert.message || '')}</div>
                                        <div style="font-size: 12px; color: #9e9e9e;">
                                            ğŸ“ ${escapeHtml(alert.location || 'ìœ„ì¹˜ ì •ë³´ ì—†ìŒ')} | 
                                            ğŸ’¾ ${escapeHtml(alert.value || 'N/A')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            } catch (e) {
                console.error('Early warning error:', e);
                summaryDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
                alertsDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
            }
        }
        
        // ê²½ê³  ìƒì„¸ ì •ë³´ í‘œì‹œ
        function showAlertDetails(index, alert) {
            // ëª¨ë‹¬ ë˜ëŠ” ìƒì„¸ ì •ë³´ í‘œì‹œ
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.7);
                z-index: 1000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            `;
            
            const severityColor = {
                'critical': '#e57373',
                'warning': '#fdd835',
                'info': '#9e9e9e'
            }[alert.severity] || '#9e9e9e';
            
            modal.innerHTML = `
                <div style="
                    background: #2b2b2f;
                    border: 1px solid #3d3d42;
                    border-radius: 8px;
                    max-width: 600px;
                    width: 100%;
                    max-height: 80vh;
                    overflow-y: auto;
                    padding: 24px;
                ">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin: 0; color: #d8d9da;">ê²½ê³  ìƒì„¸ ì •ë³´</h2>
                        <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="
                            background: transparent;
                            border: none;
                            color: #9e9e9e;
                            font-size: 24px;
                            cursor: pointer;
                            padding: 0;
                            width: 32px;
                            height: 32px;
                        ">Ã—</button>
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                            <span style="
                                background: ${severityColor};
                                color: #fff;
                                padding: 4px 12px;
                                border-radius: 4px;
                                font-size: 12px;
                                font-weight: 600;
                                text-transform: uppercase;
                            ">${alert.severity || 'info'}</span>
                            <span style="font-weight: 600; color: #d8d9da; font-size: 18px;">${escapeHtml(alert.metric || 'ì•Œ ìˆ˜ ì—†ìŒ')}</span>
                        </div>
                        <div style="color: #d8d9da; margin-bottom: 8px; font-size: 16px;">${escapeHtml(alert.message || '')}</div>
                        <div style="font-size: 14px; color: #9e9e9e;">
                            ğŸ“ ìœ„ì¹˜: ${escapeHtml(alert.location || 'ìœ„ì¹˜ ì •ë³´ ì—†ìŒ')}<br>
                            ğŸ’¾ ê°’: ${escapeHtml(alert.value || 'N/A')}
                        </div>
                    </div>
                    
                    ${alert.analysis ? `
                        <div style="margin-bottom: 16px;">
                            <h3 style="color: #d8d9da; margin-bottom: 8px; font-size: 16px;">ë¶„ì„</h3>
                            <div style="
                                background: #1f1f23;
                                padding: 12px;
                                border-radius: 4px;
                                color: #d8d9da;
                                white-space: pre-wrap;
                                font-size: 14px;
                                line-height: 1.6;
                            ">${escapeHtml(alert.analysis)}</div>
                        </div>
                    ` : ''}
                    
                    ${alert.solutions && alert.solutions.length > 0 ? `
                        <div>
                            <h3 style="color: #d8d9da; margin-bottom: 8px; font-size: 16px;">í•´ê²°ì±…</h3>
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                ${alert.solutions.map((solution, idx) => `
                                    <div style="
                                        background: #1f1f23;
                                        padding: 12px;
                                        border-radius: 4px;
                                        border-left: 3px solid ${severityColor};
                                    ">
                                        <div style="font-weight: 600; color: #d8d9da; margin-bottom: 4px;">${escapeHtml(solution.name || `í•´ê²°ì±… ${idx + 1}`)}</div>
                                        <div style="font-size: 13px; color: #9e9e9e; margin-bottom: 4px;">${escapeHtml(solution.description || '')}</div>
                                        ${solution.command ? `
                                            <div style="
                                                background: #2b2b2f;
                                                padding: 8px;
                                                border-radius: 4px;
                                                font-family: monospace;
                                                font-size: 12px;
                                                color: #73bf69;
                                                margin-top: 4px;
                                            ">${escapeHtml(solution.command)}</div>
                                        ` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            document.body.appendChild(modal);
        }
        
        // ë…¸ë“œ ìƒíƒœ ëª¨ë‹ˆí„°ë§
        async function loadNodeStatus() {
            const summaryDiv = document.getElementById('nodeStatusSummary');
            const detailsDiv = document.getElementById('nodeStatusDetails');
            
            summaryDiv.innerHTML = '<div class="loading"></div> ë¡œë”© ì¤‘...';
            detailsDiv.innerHTML = '';
            
            try {
                const res = await fetch(`${API_BASE}/k8s/nodes`);
                const data = await res.json();
                const nodes = data.nodes || [];
                
                // ìƒíƒœë³„ ì§‘ê³„
                const statusCount = {};
                nodes.forEach(node => {
                    const status = node.status || 'Unknown';
                    statusCount[status] = (statusCount[status] || 0) + 1;
                });
                
                // ìš”ì•½ ì¹´ë“œ
                summaryDiv.innerHTML = Object.entries(statusCount).map(([status, count]) => {
                    const color = status === 'Ready' ? '#73bf69' : '#e57373';
                    return `
                        <div class="metric-card">
                            <div class="metric-label">${status}</div>
                            <div class="metric-value" style="color: ${color}">${count}</div>
                        </div>
                    `;
                }).join('');
                
                // ìƒì„¸ í…Œì´ë¸”
                if (nodes.length > 0) {
                    detailsDiv.innerHTML = `
                        <h3 style="margin-bottom: 16px;">ë…¸ë“œ ìƒì„¸ ëª©ë¡</h3>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th style="width: 200px;">ë…¸ë“œ ì´ë¦„</th>
                                        <th>ìƒíƒœ</th>
                                        <th>CPU</th>
                                        <th>Memory</th>
                                        <th>Pod ìš©ëŸ‰</th>
                                        <th>ë°°í¬ëœ Pod</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${nodes.map((node, idx) => {
                                        const podList = node.podList || [];
                                        const nodeId = `node-${idx}`;
                                        return `
                                        <tr>
                                            <td>
                                                <strong style="cursor: pointer; color: #3274d9;" onclick="toggleNodePods('${nodeId}')">
                                                    ${escapeHtml(node.name || '')} 
                                                    ${podList.length > 0 ? `(${podList.length})` : '(0)'}
                                                    <span id="toggle-${nodeId}" style="font-size: 12px;">â–¼</span>
                                                </strong>
                                            </td>
                                            <td>
                                                <span class="status ${node.status === 'Ready' ? 'success' : 'error'}" style="padding: 4px 8px; font-size: 12px;">
                                                    ${escapeHtml(node.status || 'Unknown')}
                                                </span>
                                            </td>
                                            <td>${escapeHtml(node.cpu || 'N/A')}</td>
                                            <td>${escapeHtml(node.memory || 'N/A')}</td>
                                            <td>${escapeHtml(node.pods || 'N/A')}</td>
                                            <td>
                                                <span style="font-size: 12px; color: #666;">
                                                    ${podList.length}ê°œ Pod
                                                </span>
                                            </td>
                                        </tr>
                                        <tr id="${nodeId}" style="display: none;">
                                            <td colspan="6" style="padding: 16px; background: #f8f9fa; border-top: none;">
                                                ${podList.length > 0 ? `
                                                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 12px;">
                                                        ${podList.map(pod => {
                                                            const detailedStatus = pod.detailedStatus || pod.status || 'Unknown';
                                                            const statusInfo = getStatusColor(detailedStatus);
                                                            return `
                                                            <div style="padding: 12px; background: white; border-radius: 6px; border: 1px solid #e0e0e0; border-left: 4px solid ${statusInfo.color};">
                                                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                                                    <strong style="font-size: 13px; color: #333;">${escapeHtml(pod.name)}</strong>
                                                                    <span class="status ${statusInfo.class}" style="padding: 2px 6px; font-size: 11px; background: ${statusInfo.color}; color: white; border-radius: 4px; font-weight: 600;">
                                                                        ${escapeHtml(detailedStatus)}
                                                                    </span>
                                                                </div>
                                                                <div style="font-size: 11px; color: #666;">
                                                                    <div>ë„¤ì„ìŠ¤í˜ì´ìŠ¤: ${escapeHtml(pod.namespace)}</div>
                                                                    <div>ì»¨í…Œì´ë„ˆ: ${pod.containers}ê°œ</div>
                                                                    <div>Ready: ${pod.ready ? 'âœ…' : 'âŒ'}</div>
                                                                    ${pod.statusReason ? `<div style="color: #e57373; margin-top: 4px;">${escapeHtml(pod.statusReason)}</div>` : ''}
                                                                </div>
                                                            </div>
                                                        `;
                                                        }).join('')}
                                                    </div>
                                                ` : '<div style="color: #999; font-size: 13px;">ì´ ë…¸ë“œì— ë°°í¬ëœ Podê°€ ì—†ìŠµë‹ˆë‹¤.</div>'}
                                            </td>
                                        </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                } else {
                    detailsDiv.innerHTML = '<div class="status warning">ë…¸ë“œê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                }
            } catch (e) {
                summaryDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
                detailsDiv.innerHTML = '';
            }
        }
        
        // ë…¸ë“œ Pod ëª©ë¡ í† ê¸€ í•¨ìˆ˜
        function toggleNodePods(nodeId) {
            const row = document.getElementById(nodeId);
            const toggle = document.getElementById(`toggle-${nodeId}`);
            if (row) {
                if (row.style.display === 'none') {
                    row.style.display = 'table-row';
                    if (toggle) toggle.textContent = 'â–²';
                } else {
                    row.style.display = 'none';
                    if (toggle) toggle.textContent = 'â–¼';
                }
            }
        }
        
        // AI ë¶„ì„ í•¨ìˆ˜ë“¤
        async function analyzeMetrics() {
            const k8sQuery = document.getElementById('k8sMetricsQuery').value;
            const customQuery = document.getElementById('metricsQuery').value;
            const query = customQuery || k8sQuery;
            
            const statusDiv = document.getElementById('metricsStatus');
            statusDiv.innerHTML = '<div class="loading"></div> ë¶„ì„ ì¤‘...';
            
            try {
                const res = await fetch(`${API_BASE}/analyze/metrics`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query, startTime: Date.now() - 3600000, endTime: Date.now() })
                });
                
                const data = await res.json();
                statusDiv.innerHTML = '<div class="status success">ë¶„ì„ ì™„ë£Œ</div>';
                
                if (data.analysis) {
                    const analysisDiv = document.getElementById('metricsAnalysis');
                    analysisDiv.innerHTML = `
                        <div class="analysis-result">
                            <h3>AI ë¶„ì„ ê²°ê³¼</h3>
                            <div class="analysis-text">${safeHtml(data.analysis)}</div>
                        </div>
                    `;
                    analysisDiv.classList.remove('hidden');
                }
                
                if (data.graphData && data.graphData.length > 0) {
                    const chartDiv = document.getElementById('metricsChart');
                    chartDiv.classList.remove('hidden');
                    const ctx = document.createElement('canvas');
                    chartDiv.innerHTML = '';
                    chartDiv.appendChild(ctx);
                    
                    if (charts.metricsChart) charts.metricsChart.destroy();
                    charts.metricsChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: data.graphData.map(d => new Date(d.timestamp * 1000).toLocaleTimeString('ko-KR', { timeZone: 'Asia/Seoul' })),
                            datasets: [{
                                label: query,
                                data: data.graphData.map(d => parseFloat(d.value)),
                                borderColor: '#3274d9',
                                backgroundColor: 'rgba(50, 116, 217, 0.1)',
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { labels: { color: '#d8d9da' } }
                            },
                            scales: {
                                y: { ticks: { color: '#9e9e9e' }, grid: { color: '#3d3d42' } },
                                x: { ticks: { color: '#9e9e9e' }, grid: { color: '#3d3d42' } }
                            }
                        }
                    });
                }
            } catch (e) {
                statusDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
            }
        }
        
        async function analyzeLogs() {
            const level = document.getElementById('logLevel').value;
            const hours = parseInt(document.getElementById('logHours').value);
            const podName = document.getElementById('podName').value;
            const namespace = document.getElementById('namespace').value;
            
            const statusDiv = document.getElementById('logsStatus');
            statusDiv.innerHTML = '<div class="loading"></div> ë¶„ì„ ì¤‘...';
            
            try {
                const res = await fetch(`${API_BASE}/analyze/logs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        level,
                        podName: podName || undefined,
                        namespace: namespace || undefined,
                        startTime: Date.now() - hours * 3600000,
                        endTime: Date.now()
                    })
                });
                
                const data = await res.json();
                statusDiv.innerHTML = '<div class="status success">ë¶„ì„ ì™„ë£Œ</div>';
                
                if (data.analysis) {
                    const analysisDiv = document.getElementById('logsAnalysis');
                    analysisDiv.innerHTML = `
                        <div class="analysis-result">
                            <h3>AI ë¶„ì„ ê²°ê³¼</h3>
                            <div class="analysis-text">${safeHtml(data.analysis)}</div>
                        </div>
                    `;
                    analysisDiv.classList.remove('hidden');
                }
            } catch (e) {
                statusDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
            }
        }
        
        async function analyzeTraces() {
            const service = document.getElementById('traceService').value;
            
            const statusDiv = document.getElementById('tracesStatus');
            statusDiv.innerHTML = '<div class="loading"></div> ë¶„ì„ ì¤‘...';
            
            try {
                const res = await fetch(`${API_BASE}/analyze/traces`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ service, startTime: Date.now() - 3600000, endTime: Date.now() })
                });
                
                const data = await res.json();
                statusDiv.innerHTML = '<div class="status success">ë¶„ì„ ì™„ë£Œ</div>';
                
                if (data.analysis) {
                    const analysisDiv = document.getElementById('tracesAnalysis');
                    analysisDiv.innerHTML = `
                        <div class="analysis-result">
                            <h3>AI ë¶„ì„ ê²°ê³¼</h3>
                            <div class="analysis-text">${safeHtml(data.analysis)}</div>
                        </div>
                    `;
                    analysisDiv.classList.remove('hidden');
                }
                
                if (data.traceData && data.traceData.length > 0) {
                    const chartDiv = document.getElementById('tracesChart');
                    chartDiv.classList.remove('hidden');
                    const ctx = document.createElement('canvas');
                    chartDiv.innerHTML = '';
                    chartDiv.appendChild(ctx);
                    
                    if (charts.tracesChart) charts.tracesChart.destroy();
                    charts.tracesChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: data.traceData.map(d => d.service || 'Unknown'),
                            datasets: [{
                                label: 'ì‘ë‹µ ì‹œê°„ (ms)',
                                data: data.traceData.map(d => d.duration || 0),
                                backgroundColor: '#3274d9'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { labels: { color: '#d8d9da' } }
                            },
                            scales: {
                                y: { ticks: { color: '#9e9e9e' }, grid: { color: '#3d3d42' } },
                                x: { ticks: { color: '#9e9e9e' }, grid: { color: '#3d3d42' } }
                            }
                        }
                    });
                }
            } catch (e) {
                statusDiv.innerHTML = `<div class="status error">ì—ëŸ¬: ${e.message}</div>`;
            }
        }
        
        // ë…¸ë“œ ëª©ë¡ ë¡œë“œ
        async function loadNodes() {
            try {
                const res = await fetch(`${API_BASE}/k8s/nodes`);
                const data = await res.json();
                const select = document.getElementById('nodeSelector');
                
                // ê¸°ì¡´ ì˜µì…˜ ìœ ì§€ (ëª¨ë“  ë…¸ë“œ)
                const allOption = select.querySelector('option[value="all"]');
                select.innerHTML = '';
                select.appendChild(allOption);
                
                // ë…¸ë“œ ì˜µì…˜ ì¶”ê°€
                (data.nodes || []).forEach(node => {
                    const option = document.createElement('option');
                    option.value = node.name;
                    option.textContent = `${node.name} (${node.status})`;
                    select.appendChild(option);
                });
                
                // ë…¸ë“œ ì„ íƒ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                select.addEventListener('change', function() {
                    const selectedNode = this.value;
                    // Pod ìƒíƒœ ëª¨ë‹ˆí„°ë§ì´ ë¡œë“œë˜ì–´ ìˆìœ¼ë©´ ìƒˆë¡œê³ ì¹¨
                    if (loadedSections.has('section-pod-status')) {
                        loadPodStatus();
                    }
                });
            } catch (e) {
                console.error('Load nodes error:', e);
            }
        }
        
        // WebSocket ì—°ê²° (ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ)
        let ws = null;

        function connectWebSocket() {
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsUrl = `${protocol}//${window.location.host}/ws`;
            
            try {
                ws = new WebSocket(wsUrl);
                
                ws.onopen = () => {
                    console.log('[WebSocket] ì—°ê²°ë¨');
                };
                
                ws.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        handleWebSocketMessage(data);
                    } catch (error) {
                        console.error('[WebSocket] ë©”ì‹œì§€ íŒŒì‹± ì˜¤ë¥˜:', error);
                    }
                };
                
                ws.onerror = (error) => {
                    console.error('[WebSocket] ì˜¤ë¥˜:', error);
                };
                
                ws.onclose = () => {
                    console.log('[WebSocket] ì—°ê²° ì¢…ë£Œ, 5ì´ˆ í›„ ì¬ì—°ê²° ì‹œë„...');
                    setTimeout(connectWebSocket, 5000);
                };
            } catch (error) {
                console.error('[WebSocket] ì—°ê²° ì‹¤íŒ¨:', error);
            }
        }

        function handleWebSocketMessage(data) {
            switch (data.type) {
                case 'metrics':
                    // ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸ (í–¥í›„ í™•ì¥)
                    console.log('[WebSocket] ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸:', data.data);
                    break;
                case 'connection':
                    console.log('[WebSocket] ì—°ê²° ìƒíƒœ:', data.status);
                    break;
            }
        }


        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            loadNodes();
            connectWebSocket(); // WebSocket ì—°ê²°
            handleScroll(); // ì´ˆê¸° ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ ì„¹ì…˜ í‘œì‹œ
            
            // ì£¼ê¸°ì  ìƒˆë¡œê³ ì¹¨ (30ì´ˆë§ˆë‹¤)
            setInterval(() => {
                if (loadedSections.has('section-cluster-overview')) {
                    loadClusterStats();
                }
                if (loadedSections.has('section-resources')) {
                    if (selectedPod) {
                        loadContainerCpu();
                        loadContainerMemory();
                        loadPodCpu();
                        loadPodMemory();
                    }
                }
                if (loadedSections.has('section-performance-metrics')) {
                    loadPerformanceMetrics();
                }
                if (loadedSections.has('section-system-load')) {
                    loadSystemLoadMetrics();
                }
                if (loadedSections.has('section-availability-budget')) {
                    loadAvailabilityBudgetMetrics();
                }
                if (loadedSections.has('section-early-warning')) {
                    loadEarlyWarning();
                }
                if (loadedSections.has('section-pod-status')) {
                    loadPodStatus();
                }
                if (loadedSections.has('section-node-status')) {
                    loadNodeStatus();
                }
            }, 30000);
        });
        
        // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        window.addEventListener('scroll', handleScroll);
        window.addEventListener('resize', handleScroll);
    </script>
</body>
</html>
